# PROJECT #3: CUSTOM SOLANA PROGRAM

**OVERVIEW:** 

This project aims to develop a **decentralized application (DApp)** featuring a **calculator** implemented in **Rust**. We'll create a test using Mocha written in JavaScript, ensuring robust code validation. The following is necessary **prerequisites**—Node.js, Solana, Rust, Anchor, and Mocha—have been outlined and documented in the initial ReadMe.md of this repository.

**INTRO:**

In the context of Solana, **programs represent the code executed on the Solana Blockchain**. Notably, Solana programs are inherently "stateless," signifying their inability to store data. To circumvent this limitation, the solution involves the utilization of accounts. These **accounts serve as virtual "files" stored on the Solana Blockchain**, enabling essential data storage for the calculator DApp. This approach ensures efficient data management within the Solana ecosystem while adhering to the platform's architectural principles.

## Set-up
 Open a new terminal window and let's initialize our anchor project `anchor init app-name`. Once the anchor project is initialized let's test to see if everything is working fine.

 ```
anchor init sol-program
```

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/646c359c-495f-4aba-9d54-02d4fc312600)


And open the project in VScode; 
1. Navigate to the Remote Explorer 
2. Select the `sol-program` you just created.
3. Navigate to `programs/sol-program/src/lib.rs`

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/0749ae1b-b41a-44fe-bb2c-2cb7a837d7c8)

This is the default program that Anchor has provided. Simply, have a user-defined function called `initialize(...)` whenever initialize is called it successfully exits the program. 

## Anchor Project

With the project environment configured, we can proceed by navigating to the project directory using the terminal. Execute the following command:

```
cd sol-program
```

### Build

Once inside the project directory, the next step is to build the project using the Anchor framework. Initiate the build process with the following command:

```
anchor build
```

**This command triggers the compilation of the Rust code and generates the necessary artifacts for deploying and interacting with the Solana program.** Successful execution of the `anchor build` command is crucial for ensuring that the project is correctly compiled and ready for deployment. Any error messages or warnings during this process should be carefully addressed to guarantee the reliability and functionality of the deployed Solana program.

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/62178822-4135-4962-8950-901eec8b5b11)

In the picture above, I show the **error** that I got on my run and how I solved it:
1. I got an error on my first try.
2. After a quick Google search, I found the solution,
3. adding `ahash = "=0.8.6"` to my `sol-program/programs/sol-program/Cargo.toml` file.

A **successful** build will;
1. Return `Finished` in the terminal and...
2. Populate `sol-program/target/idl/sol_program.json`

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/5b02866a-44d2-4bfa-9933-c325edd80f83)

The idl folder defines the interface description language, detailing contract instructions. It aids testing and facilitates front-end integration. Now, let's test our Solana program using Anchor. Testing ensures code reliability, and the IDL serves as a guide, aligning expectations with contract behavior. 

### Test

In `sol-program/tests/sol-program.ts` we can find the test script that gets autogenerated. 

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/83d8f0e2-cc3f-4dde-b557-5ada966abe36)

Now, back in your terminal run `anchor test` to run our test code. If this runs successfully you should get a pass.

```
anchor test
```

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/cd581216-3336-4ff2-940f-86ca532d5582)

## Create Function

Let's now head back to `sol-program/programs/sol-grogram/src/lib.rs` and remove the public function initialize `pub fn initialize(...)` and the public structure that calls initialize `pub struct Initialize {}`. Below I have an example of what the file, `lib.rs` should look like before (left) and after we clean it up (right). 

![image](https://github.com/jvick1/Intro_to_SOL/assets/32043066/f164b9d5-438c-4ece-9fd8-2cc3e0569da1)

Let's create our first function... this will be a public function called create `pub fn create()`. 

The first argument of these functions are always context `ctx: Context<Create>`. **Remember that in Solana programs are stateless which means they can't hold data.** So, if you want to store data on Solana we have to create an account which is like a file where we can store data and we can put that account on the Blockchain. Then with our program, using code, we can retrieve the data that we want from that account. 

The next argument will be a string called init_message `init_message: String`. This will be the greeting message displayed when we start this program. If any of this Rust code is confusing so far check out my intro to [Rust Repo](https://github.com/jvick1/Rust_Intro) I have a few intro projects there and I am adding more whenever I am not too lazy!

The return type will be called ProgramResult. Inside the function, we can write `let calculator = &mut ctx.accounts.calculator;`. This lets us get our calculator account from context we specify `&mut` because we are going to modify this account. The next line is where we modify the account and we do that with `calculator.greeting = init_message;`.  Lastly, we use `Ok(())` to let Solana know everything was run successfully. Your `lib.rs` file should look something like this:

```
//lib.rs
use anchor_lang::prelude::*;

declare_id!("3PrLAA3B2KJHJKLYxWVe4ihfbh6c3pwvzPsD5dEas7mw");

#[program]
pub mod sol_program {
    use super::*;
    pub fn create(ctx: Context<Create>, init_message: String) -> ProgramResult {
        let calculator = &mut ctx.accounts.calculator;
        calculator.greeting = init_message;
        Ok(())
    }
}
```

And there we go! You have written your first Solana Function!
